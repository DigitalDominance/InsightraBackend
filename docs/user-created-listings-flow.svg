<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="900" height="1400" viewBox="0 0 900 1400" role="img">
  <style>
    .box { rx:24; ry:24; fill:#ffffff; stroke:#111827; stroke-width:2.5; }
    .title { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Inter, Arial; font-size:44px; font-weight:700; fill:#111827; }
    .label { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Inter, Arial; font-size:32px; fill:#111827; }
    .small { font-size:28px; fill:#374151; }
    .arrow { stroke:#111827; stroke-width:3; marker-end: url(#arrowhead); fill:none; }
  </style>
  <defs>
    <marker id="arrowhead" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto">
      <polygon points="0 0, 12 4, 0 8" fill="#111827"></polygon>
    </marker>
  </defs>

  <text x="450" y="70" text-anchor="middle" class="title">User-created Market Listing Flow</text>

  <!-- User -->
  <rect x="80" y="120" width="740" height="140" class="box" fill="#ecfeff" stroke="#06b6d4"/>
  <text x="120" y="190" class="label">User</text>
  <text x="120" y="230" class="small">Holds BOND_TOKEN and calls submit*</text>

  <!-- Approve -->
  <rect x="80" y="320" width="740" height="140" class="box"/>
  <text x="120" y="390" class="label">Approve 100 BOND_TOKEN → Factory</text>
  <text x="120" y="430" class="small">ERC20 approve(factory, 100 * 10^decimals)</text>

  <!-- Factory -->
  <rect x="80" y="520" width="740" height="180" class="box" fill="#eef2ff" stroke="#818cf8"/>
  <text x="120" y="590" class="label">Factory</text>
  <text x="120" y="630" class="small">_collectCreationFee() → transferFrom(user → feeSink)</text>
  <text x="120" y="670" class="small">Deploy market, register, emit *Created</text>

  <!-- Market -->
  <rect x="80" y="750" width="740" height="160" class="box" fill="#ecfdf5" stroke="#10b981"/>
  <text x="120" y="820" class="label">New Market</text>
  <text x="120" y="860" class="small">Holds collateral logic; reads Redeem fee bps</text>

  <!-- Registry -->
  <rect x="80" y="950" width="740" height="160" class="box" fill="#fffbeb" stroke="#f59e0b"/>
  <text x="120" y="1020" class="label">Factory Registry</text>
  <text x="120" y="1060" class="small">allMarkets[], isMarket(), isRemoved()</text>

  <!-- DAO -->
  <rect x="80" y="1150" width="740" height="160" class="box" fill="#fef2f2" stroke="#ef4444"/>
  <text x="120" y="1220" class="label">DAO / Governing Wallet</text>
  <text x="120" y="1260" class="small">removeListing(market, reason) / restoreListing()</text>

  <!-- arrows -->
  <line x1="450" y1="260" x2="450" y2="320" class="arrow"/>
  <line x1="450" y1="460" x2="450" y2="520" class="arrow"/>
  <line x1="450" y1="700" x2="450" y2="750" class="arrow"/>
  <line x1="450" y1="910" x2="450" y2="950" class="arrow"/>
  <line x1="450" y1="1110" x2="450" y2="1150" class="arrow"/>
</svg>
